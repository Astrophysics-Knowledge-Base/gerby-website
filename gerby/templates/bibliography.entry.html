{% extends "layout.html" %}

{% block title %}Bibliography entry{% endblock %}

{% block breadcrumb %}
  <li><a href="/bibliography">Bibliography</a>
{% endblock %}

{% block body %}
  <dl class="entry">
    <!-- Bootstrap 4 removes dl-horizontal, right now there is an approximation of this TODO improve: fixed width for labels e.g. is necessary -->
    {% if "author" in entry.fields %}
      <dt>author</dt>
      <dd>{{ entry.fields["author"] }}</dd>
    {% endif %}

    {% if "title" in entry.fields %}
      <dt>title</dt>
      <dd>{{ entry.fields["title"] }}</dd>
    {% endif %}

    {% if "year" in entry.fields %}
      <dt>year</dt>
      <dd>{{ entry.fields["year"] }}</dd>
    {% endif %}

    {% if "journal" in entry.fields %}
      <dt>journal</dt>
      <dd>{{ entry.fields["journal"] }}</dd>
    {% endif %}

    {% if "publisher" in entry.fields %}
      <dt>publisher</dt>
      <dd>{{ entry.fields["publisher"] }}</dd>
    {% endif %}

    {% if "series" in entry.fields %}
      <dt>series</dt>
      <dd>{{ entry.fields["series"] }}</dd>
    {% endif %}

    {% if "volume" in entry.fields %}
      <dt>volume</dt>
      <dd>{{ entry.fields["volume"] }}</dd>
    {% endif %}

    {% if "number" in entry.fields %}
      <dt>number</dt>
      <dd>{{ entry.fields["number"] }}</dd>
    {% endif %}

    {% if "pages" in entry.fields %}
      <dt>pages</dt>
      <dd>{{ entry.fields["pages"] | replace("--", "&ndash;") | safe }}</dd>
    {% endif %}

    {% if "eprint" in entry.fields %}{# assume it's arXiv #}
      <dt>arXiv</dt>
      <dd><a href="https://arxiv.org/abs/{{ entry.fields["eprint"] }}">{{ entry.fields["eprint"] }}</a></dd>
    {% endif %}

    {% if "url" in entry.fields %}
      <dt>url</dt>
      <dd><a href="{{ entry.fields["url"] }}">{{ entry.fields["url"] }}</a></dd>
    {% endif %}
  </dl>

  {% if citations | length == 1 %}
    <p>This item is referenced in 1 tag:
  {% elif citations | length > 1 %}
    <p>This item is referenced in {{ citations | length }} tags:
  {% endif %}

  {% if citations | length >= 1 %}
    <ul>
      {% for citation in citations %}
        {# TODO maybe refactor this output type: it also appears in tag.show.html and maybe other places #}
      <li>{{ citation["tag"].type | capitalize }} <a href="{{ tagURL(citation["tag"].tag) }}" data-tag="{{ citation["tag"].tag }}">{{ citation["tag"].ref }}</a>
      {# TODO I can't get the join to work properly, just integrate LabelName in Tag and get rid of the necessity of joins! {% if citation["labelname"].name %}: {{ citation["labelname"].name | safe }}{% endif %}#}
      {% endfor %}
    </ul>
  {% endif %}
{% endblock %}
