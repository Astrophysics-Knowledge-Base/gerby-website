{% extends "layout.html" %}

{% block title %}Statistics for tag {{ tag.tag }}{% endblock %}

{% block head %}
  <script type="text/javascript" src="/static/js/toggle.js"></script>
{% endblock %}

{% block breadcrumb %}

{% for parent in breadcrumb %}
  <li{% if loop.last %} class="active"{% endif %}>{{ parent.type | capitalize }} <a href="{{ tagURL(parent.tag) }}" data-tag="{{ parent.tag }}">{{ parent.ref }}</a>{% if parent.name %}: {{ parent.name }}{% endif %}
  {% if loop.last %}<span id="citation">(<a href="{{ tagURL(parent.tag) }}/cite">cite</a>)</span>{% endif %}
{% endfor %}

{% endblock %}

{% macro neighboursMacro(neighbours) %}

<ul class="neighbours">
{% if neighbours[0] %}
  <li class="left"><a href="{{ tagURL(neighbours[0].tag) }}/statistics">previous {{ neighbours[0].type }}</a>
{% endif %}
{% if neighbours[1] %}
  <li class="right"><a href="{{ tagURL(neighbours[1].tag) }}/statistics">next {{ neighbours[1].type }}</a>
{% endif %}
</ul>
{% if neighbours[0] or neighbours[1] %}<br style="clear:both">{% endif %}

{% endmacro %}

{% block hamburger %}
  {{ neighboursMacro(neighbours) }}
{% endblock %}

{% block body %}
<h2>Statement of tag <span class="tag">{{ tag.tag }}</span></h2>

<div class="html">
  {{ tag.html | safe }}
</div>
<p>

<h2>Statistics of tag <span class="tag">{{ tag.tag }}</span></h2>

{% if dependencies | length > 0 %}
<h3 id="dependencies">Tags using this result</h3>
<ul>
{% for dependency in dependencies %}
  <li>{{ dependency.tag.type | capitalize }} <a href="/tag/{{ dependency.tag.tag }}" data-tag="{{ dependency.tag.tag }}">{{ dependency.tag.ref }}</a>
  in {{ dependency.parent.type | capitalize }} <a href="/tag/{{ dependency.parent.tag }}" data-tag="{{ dependency.parent.tag }}">{{ dependency.parent.ref }}</a>: {{ dependency.parent.name }}
    <br>(go to <a href="/tag/{{ dependency.tag.tag }}/statistics">statistics</a>)
{% endfor %}
</ul>
{% endif %}

{% endblock %}

{% block sidebar %}
  <div id="interaction">
  {{ neighboursMacro(neighbours) }}
  </div>

  <hr>

  <div id="information">
    <ul id="tag-info">
      <li id="tag-history"><a href="/tag/{{ tag.tag }}/history">history</a>
      <li id="tag-statistics"><a href="/tag/{{ tag.tag }}/statistics">statistics</a>
      {% if dependencies | length > 0 %}
        <li id="tag-dependencies"><a href="/tag/{{ tag.tag }}/statistics#dependencies">{{ dependencies | length }} tag{% if dependencies | length > 1 %}s{% endif %} depend{% if dependencies | length == 1 %}s{% endif %} on this tag</a>
      {% endif %}
    </ul>
  </div>
{% endblock %}

